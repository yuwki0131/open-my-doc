# Scalaと関数型プログラミングとは まとめ
* Scala向け
* そういう傾向があるという話。
* 同じ関数型言語でも結構言語によって慣習が違う。

## なぜ、関数型プログラミングをするのか?

### デザインパターン
* Strategy
* TemplateMethod

オブジェクト指向プログラミングにおけるデザインパターンのいくつかが不要になる(標準で使えるようになる)

### immutable
* 再代入を行わない
* データ型では代入は、最初の1回のみ。
* データ構造を破壊しないことで、思考コスト、オブジェクトがどこで書き換えられるかの調査コストが減る。(副作用のないプログラミング)
  * どこでデータが書き換えられるかを考える必要が無くなる。
  * 関数の入力と出力のみに注目すればいい。
    (参照透過性: 引数に同じ値を与えれば同じ戻り値を得ることができる関数を参照透過性な関数という)
  * 入力に対して、想定した出力が得られれば、正しい関数であると言える。(プロパティベースのテスト(関数に対するユニットテスト))
  * (注)別に関数型プログラミングだからというわけではない。Javaなど他の言語でもある程度同じことが可能。
    * 但し、Javaは破壊的な変更に対して保証してくれませんよ。。。。

### その他
* そもそも静的に型付されるかどうかはあんまり関係ないですよ。。。

## 無名関数(ラムダ抽象)/高階関数
* 大体、無名関数かラムダ式でググったら出てくる。ラムダ式とはあんまり言わない
* 第一級オブジェクトとしての関数(データとして扱う事が出来る関数)
* map { a => a }の←これ
* 関数を渡す
* C言語の関数のポインタと何が違うのか? / JavaのStrategyパターンと何が違うのか。

## レキシカルスコープ
この時、aは、
```
{ a => { (a) => a }}
```

## 再帰
* あんまり使わないが、たまに使う。
* 木構造のような再帰的なデータ型があると使う。
* リストについても使えるが、後述の通りあまり使わない
* Scalaの再帰は末尾最適化をする場合としない場合がある。
* Trampolineで末尾最適化をする。

## 代数的データ型
* 関数型プログラミングだと実装とデータ型を分離する傾向がある。
  * データに実装が付随しがちなオブジェクト指向プログラミングとは少し違う。。。
  * 実装とは 独立した
  * 静的型付の関数型言語だと、ここからFunctorや
    * ちなみにClojureだとimmutableHashmapやリストを使うことが多い
* オブジェクトが破壊されないことの保証
  * 一つはval(Javaで言うところのfinalを付ける)によるデータ型
  * またははimmutableな標準型、immutableなhashmap、list、etc...
  * 最後の一つはTupleによるプログラミング、否、case classによるデータ定義

## リスト
* ScalaだとSeqで書くのがマナーらしい
* 標準のArrayListとLinkedListがある。
* 関数型のLinkedList(主に単方向連結リスト)は特殊な性質がある。

## リスト操作関数
* map, filter, foldあたりが王道。flatMap, flatten
* 関数型プログラミングではリスト操作関数を多用することが多い。 => slickに繋がる
  * SQLもまた宣言型言語なので、map/filterなどの組み合わせはSQLに変換しやすいのかもしれない。。。

## Future, for式

## 型まわりの話
* 複雑な型を定義してもあんまり意味ないという側面はある。

* 気を抜いているとAnyに推論されるらしい。
* http://keens.github.io/slide/DOT_dottynitsuiteshirabetemita/

### implicitな型パラメータ

### 構造的部分型

### 型クラス

## やらない関数型言語まわりのトピック
* 継続(continuation)
* プログラムの融合変換(program fusion, deforestation)
* なんとかモルフィズム(正確にはRecursion Schemeという。catamorphism, anamorphism, hylomorphism ...)
* モナドまわり
* 抽象解釈(abstract interpretation)
* コンビネータロジック、ラムダ計算、圏論
* 証明、定理証明支援系
* プログラム意味論
* 型システム
* 依存型(dependent type) (path-dependent type)

## Dotty
https://qiita.com/kmizu/items/10940b4c46876ae8a12d

## 参考文献
* path-dependent type: https://53ningen.com/path-dependent-types/
